{"version":3,"file":"simple-notifier.esm.js","names":["mergeOptions","require","getPropValue","motionAllowed","timeToMs","createEl","getRandomIntUnder","defaultOptions","autoHide","onlyOneNotification","parentEl","document","body","position","animations","SN","constructor","userOptions","mergedOptions","motionPref","instanceId","nId","nodes","msgData","timeoutIds","events","onlyOne","set","states","nextMsgData","animatedRun","animated","hideCallTimeout","init","Error","wrapper","nodeSkeletons","tagName","attrs","dataset","parentElFChild","firstElementChild","siblingEl","classList","contains","nextElementSibling","insertBefore","screenPosArray","split","length","add","nodeClasses","allDestroyed","CustomEvent","detail","destroy","runningDestroy","addEventListener","e","remove","hide","show","text","type","inReshow","isVisible","_reshowNotification","_initNotification","_getMsgData","_showNewNotification","role","values","Object","entries","notification","append","notificationId","shown","destroyed","once","defaultMsgData","notext","notype","message","textContent","anim","base","animTimeout","showAnim","setTimeout","dispatchEvent","hideCall","clearTimeout","inHide","nIdsArray","keys","forEach","nTimeoutIds","timeoutId","id","_hideNotification","hideAnim","className","replace","typeRegex","_destroyNotification","nodesArrayKeys","nodesArrayValues","Promise","resolve","nodeKey","node","then","catch","error","class"],"sources":["../../src/js/index.js"],"sourcesContent":["const mergeOptions = require(\"merge-options\");\nimport { getPropValue, motionAllowed, timeToMs } from \"@codebundlesbyvik/css-operations\";\nimport createEl from \"@codebundlesbyvik/element-operations\";\nimport getRandomIntUnder from \"@codebundlesbyvik/number-operations\";\n\nconst defaultOptions = {\n    autoHide: true,            // Number / Boolean\n    onlyOneNotification: true, // Boolean\n    parentEl: document.body,   // Element\n    position: \"top center\",    // String\n    animations: \"auto\"         // String / Boolean\n};\n\nclass SN {\n    constructor(userOptions = {}) {\n        this.mergedOptions = mergeOptions(defaultOptions, userOptions);\n\n        this.autoHide = this.mergedOptions.autoHide;\n        this.parentEl = this.mergedOptions.parentEl;\n        this.position = this.mergedOptions.position;\n        this.motionPref = this.mergedOptions.animations;\n\n        this.instanceId = null;\n\n        this.nId = 1;\n        this.nodes = {};\n        this.msgData = {};\n\n        this.timeoutIds = {};\n        this.events = {};\n        this.onlyOne = {\n            set: this.mergedOptions.onlyOneNotification,\n            states: {},\n            nextMsgData: {}\n        };\n\n        this.animatedRun = null;\n    }\n\n    static nodeClasses = {\n        wrapper: \"simple-notifier\",\n        notification: \"simple-notification\",\n        typeRegex: /simple-notification--[A-Za-z]+/g,\n        shown: \"is-shown\",\n        anim: {\n            base: \"animated\",\n            show: \"fadeIn\",\n            hide: \"fadeOut\"\n        }\n    }\n\n    static nodeSkeletons = {\n        wrapper: {\n            tagName: \"div\",\n            attrs: {\n                class: SN.nodeClasses.wrapper\n            }\n        },\n        notification: {\n            tagName: \"div\",\n            attrs: {\n                class: SN.nodeClasses.notification,\n                role: \"alert\"\n            }\n        },\n        message: {\n            tagName: \"p\",\n            attrs: {\n                class: `${SN.nodeClasses.notification}__message`\n            }\n        }\n    };\n\n    static defaultMsgData = {\n        notext: {\n            text: \"This is some dummy text for you, because none was passed in.\",\n            type: \"debug\"\n        },\n        notype: {\n            type: \"default\"\n        }\n    };\n\n    get animated() {\n        switch(this.motionPref) {\n            case \"undefined\":\n            case \"auto\":\n                return motionAllowed();\n            default:\n                return this.motionPref;\n        }\n    }\n\n    get hideCallTimeout() {\n        switch(this.autoHide) {\n            case true:\n                return 3500;\n            case false:\n                return 0;\n            default:\n                return this.autoHide;\n        }\n    }\n\n    init() {\n        console.log(\"SN: Running .init()...\");\n\n        if (this.instanceId) {\n            throw new Error(`SN: .init() has already been called on this instance (${this.instanceId}).`);\n        }\n\n        this.instanceId = getRandomIntUnder(100000);\n\n        this.nodes.wrapper = createEl(\n            SN.nodeSkeletons.wrapper.tagName,\n            SN.nodeSkeletons.wrapper.attrs\n        );\n\n        this.nodes.wrapper.dataset.instanceId = this.instanceId;\n\n        const parentElFChild = this.parentEl.firstElementChild;\n\n        // Insert the instance in the DOM after any earlier initialized instances sharing the same parentEl.\n        const siblingEl = parentElFChild.classList.contains(\"simple-notifier\")\n            ? parentElFChild.nextElementSibling\n            : parentElFChild;\n\n        this.parentEl.insertBefore(this.nodes.wrapper, siblingEl);\n\n        const screenPosArray = this.position.split(\" \");\n\n        // If only a y-position is set by the user, add an x-position.\n        if (screenPosArray.length === 1) {\n            screenPosArray[1] = \"center\";\n        }\n\n        this.nodes.wrapper.classList.add(\n            `${SN.nodeClasses.wrapper}--pos-y-${screenPosArray[0]}`,\n            `${SN.nodeClasses.wrapper}--pos-x-${screenPosArray[1]}`\n        );\n\n        this.events.allDestroyed = new CustomEvent(\"allNotificationsDestroyed\", { detail: {\n            instanceId: this.instanceId\n        }});\n\n        console.log(`SN: Instance ${this.instanceId} has been initialized.`);\n    }\n\n    destroy() {\n        console.log(\"SN: Running .destroy()...\");\n\n        if (!this.instanceId) {\n            throw new Error(\"SN: Instance isn't initialized!\");\n        }\n\n        if (this.runningDestroy) {\n            console.log(\"SN: .destroy was called whilst already running. Returning.\");\n\n            return;\n        }\n\n        this.runningDestroy = true;\n\n        this.nodes.wrapper.addEventListener(\"allNotificationsDestroyed\", (e) => {\n            console.log(\"SN: All notifications have been destroyed.\");\n\n            this.nodes.wrapper.remove();\n\n            if (this.onlyOne) {\n                this.onlyOne.states = {};\n                this.onlyOne.nextMsgData = {};\n            }\n\n            this.events = {};\n\n            this.nId = 1;\n\n            this.instanceId = null;\n\n            delete this.runningDestroy;\n\n            console.log(`SN: Instance ${e.detail.instanceId} has been destroyed.`);\n        });\n\n        this.hide();\n    }\n\n    show(text, type) {\n        console.log(\"SN: Running .show()...\");\n\n        if (!this.instanceId) {\n            throw new Error(\"SN: Instance isn't initialized!\");\n        }\n\n        if (this.onlyOne.set) {\n            if (this.onlyOne.states.inReshow) {\n                console.log(\"SN: onlyOneNotification === true and .show() was called during execution ._reshowNotification(). Returning.\");\n\n                return;\n            }\n\n            if (this.onlyOne.states.isVisible) {\n                console.log(\"SN: onlyOneNotification === true and notification is currently visible. Calling ._reshowNotification()...\");\n\n                this._reshowNotification(text, type);\n\n                return;\n            }\n        }\n\n        let nId = this.nId;\n\n        if (!this.onlyOne.set) {\n            this.nId++;\n        }\n\n        this._initNotification(nId);\n\n        this._getMsgData(nId, text, type);\n\n        this._showNewNotification(nId);\n    }\n\n    _initNotification(nId) {\n        console.log(`SN: Running ._initNotification() on nId ${nId}...`);\n\n        this.nodes[nId] = {};\n\n        for (const [role, values] of Object.entries(SN.nodeSkeletons)) {\n            if (role === \"wrapper\")\n                continue;\n\n            this.nodes[nId][role] = createEl(values.tagName, values.attrs);\n\n            if (role === \"notification\") {\n                this.nodes.wrapper.insertBefore(\n                    this.nodes[nId][role],\n                    this.nodes.wrapper.firstElementChild\n                );\n            } else {\n                this.nodes[nId].notification.append(this.nodes[nId][role]);\n            }\n        }\n\n        this.nodes[nId].notification.dataset.notificationId = nId;\n\n        this.timeoutIds[nId] = {};\n\n        this.events[nId] = {};\n\n        this.events[nId].shown = new CustomEvent(\"notificationShown\", { detail: {\n            instanceId: this.instanceId,\n            notificationId: nId\n        }});\n        this.events[nId].destroyed = new CustomEvent(\"notificationDestroyed\", { detail: {\n            instanceId: this.instanceId,\n            notificationId: nId\n        }});\n\n        this.nodes.wrapper.addEventListener(\n            \"notificationShown\",\n            this.events[nId].shown,\n            { once: true }\n        );\n        this.nodes.wrapper.addEventListener(\n            \"notificationDestroyed\",\n            this.events[nId].destroyed,\n            { once: true }\n        );\n    }\n\n    _getMsgData(nId, text, type) {\n        console.log(`SN: Running ._getMsgData on nId ${nId}...`);\n        \n        if (!nId) {\n            console.warn(\"SN: No nId was passed in. Returning!\")\n\n            return;\n        }\n\n        if (!text) {\n            if (this.onlyOne.nextMsgData) {\n                text = this.onlyOne.nextMsgData.text;\n                type = this.onlyOne.nextMsgData.type;\n\n                this.onlyOne.nextMsgData = {};\n            } else {\n                text = SN.defaultMsgData.notext.text;\n                type = SN.defaultMsgData.notext.type;\n            }\n        }\n\n        if (!type) {\n            type = SN.defaultMsgData.notype.type;\n        }\n\n        this.msgData[nId] = {};\n\n        this.msgData[nId].text = text;\n        this.msgData[nId].type = type;\n    }\n\n    _showNewNotification(nId) {\n        console.log(`SN: Running ._showNewNotification() on nId ${nId}...`);\n\n        this.animatedRun = this.animated;\n\n        this.nodes[nId].message.textContent = this.msgData[nId].text;\n\n        this.nodes[nId].notification.classList.add(\n            `${SN.nodeClasses.notification}--${this.msgData[nId].type}`,\n               SN.nodeClasses.shown\n        );\n\n        if (this.animatedRun) {\n            this.nodes[nId].notification.classList.add(\n                SN.nodeClasses.anim.base,\n                SN.nodeClasses.anim.show\n            );\n\n            const animTimeout = timeToMs(getPropValue(\n                this.nodes[nId].notification,\n                \"animation-duration\"\n            ));\n\n            this.timeoutIds[nId].showAnim = setTimeout(() => {\n                this.nodes[nId].notification.classList.remove(SN.nodeClasses.anim.show);\n            }, animTimeout);\n        }\n\n        if (this.onlyOne.set) {\n            this.onlyOne.states.isVisible = true;\n        }\n\n        this.nodes.wrapper.dispatchEvent(this.events[nId].shown);\n\n        if (this.hideCallTimeout > 0) {\n            this.timeoutIds[nId].hideCall = setTimeout(() => {\n                this.hide(nId);\n            }, this.hideCallTimeout);\n        } else {\n            this.animatedRun = null;\n        }\n    }\n\n    _reshowNotification(text, type) {\n        console.log(\"SN: Running ._reshowNotification()...\");\n\n        this.onlyOne.states.inReshow = true;\n\n        this.onlyOne.nextMsgData.text = text;\n        this.onlyOne.nextMsgData.type = type;\n\n        clearTimeout(this.timeoutIds[1].hideCall);\n\n        this.hide(1);\n    }\n\n    hide(nId) {\n        console.log(\"SN: Running .hide()...\");\n\n        if (!this.instanceId) {\n            throw new Error(\"SN: Instance isn't initialized!\");\n        }\n\n        if (this.onlyOne.set) {\n            if (this.onlyOne.states.inHide) {\n                console.log(\"SN: onlyOneNotification === true and .hide() was called whilst already running. Returning.\");\n\n                return;\n            }\n\n            this.onlyOne.states.inHide = true;\n        }\n\n        let nIdsArray;\n\n        if (typeof nId === \"number\") {\n            if (this.msgData[nId] === \"undefined\") {\n                console.warn(`SN: .hide() was called on a non-existant notification. Returning!`);\n\n                return;\n            }\n\n            nIdsArray = [nId];\n        }\n\n        if (typeof nId === \"undefined\") {\n            nIdsArray = Object.keys(this.msgData);\n\n            if (nIdsArray.length > 0) {\n                console.log(this.timeoutIds);\n\n                Object.values(this.timeoutIds).forEach((nTimeoutIds) => {\n                    Object.values(nTimeoutIds).forEach((timeoutId) => {\n                        clearTimeout(timeoutId);\n                    });\n                });\n            }\n            else if (this.runningDestroy) {\n                this.nodes.wrapper.dispatchEvent(this.events.allDestroyed);\n            }\n            else {\n                console.warn(\"SN: .hide() was called, but no notification is currently shown. Returning!\");\n\n                if (this.onlyOne.set) {\n                    this.onlyOne.states.inHide = false;\n                }\n\n                return;\n            }\n        }\n\n        nIdsArray.forEach((id) => {\n            this._hideNotification(id);\n        });\n\n        if (this.onlyOne.set) {\n            this.onlyOne.states.inHide = false;\n        }\n    }\n\n    _hideNotification(nId) {\n        console.log(`SN: Running ._hideNotification() on nId ${nId}...`);\n\n        if (this.animatedRun === null) {\n            this.animatedRun = this.animated;\n        }\n\n        let animTimeout = 0;\n\n        if (this.animatedRun) {\n            this.nodes[nId].notification.classList.add(SN.nodeClasses.anim.hide);\n\n            animTimeout = timeToMs(getPropValue(\n                this.nodes[nId].notification,\n                \"animation-duration\"\n            ));\n        }\n\n        this.timeoutIds[nId].hideAnim = setTimeout(() => {\n            this.nodes[nId].notification.classList.remove(SN.nodeClasses.shown);\n            this.nodes[nId].notification.className =\n                this.nodes[nId].notification.className.replace(SN.nodeClasses.typeRegex, \"\");\n\n            if (this.animatedRun) {\n                this.nodes[nId].notification.classList.remove(SN.nodeClasses.anim.hide);\n            }\n\n            if (this.onlyOne.set) {\n                this.onlyOne.states.isVisible = false;\n            }\n\n            this._destroyNotification(nId);\n        }, animTimeout);\n    }\n\n    _destroyNotification(nId) {\n        console.log(`SN: Running ._destroyNotification() on nId ${nId}...`);\n\n        const nodesArrayKeys = Object.keys(this.nodes[nId]);\n        const nodesArrayValues = Object.values(this.nodes[nId]);\n\n        new Promise((resolve) => {\n            let nodeKey = 0;\n\n            nodesArrayValues.forEach((node) => {\n                node.remove();\n\n                nodeKey++;\n\n                if (nodeKey === nodesArrayKeys.length) {\n                    resolve(\"All nodes have succesfully been removed.\");\n                }\n            });\n        })\n            .then(() => {\n                this.animatedRun = null;\n\n                delete this.nodes[nId];\n                delete this.msgData[nId];\n                delete this.timeoutIds[nId];\n\n                this.nodes.wrapper.dispatchEvent(this.events[nId].destroyed);\n\n                delete this.events[nId];\n\n                console.log(`SN: Notification ${nId} has succesfully been destroyed.`);\n\n                if (Object.keys(this.msgData).length === 0) {\n                    this.nodes.wrapper.dispatchEvent(this.events.allDestroyed);\n                }\n\n                if (this.onlyOne.set && this.onlyOne.states.inReshow) {\n                    this.onlyOne.states.inReshow = false;\n\n                    this.show();\n                }\n            })\n            .catch((error) => {\n                throw new Error(error);\n            });\n    }\n}\n\nexport default SN;\n"],"mappings":"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"}