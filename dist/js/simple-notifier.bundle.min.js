!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).SimpleNotifier=e()}(this,(function(){"use strict";function t(t,e,s){return e in t?Object.defineProperty(t,e,{value:s,enumerable:!0,configurable:!0,writable:!0}):t[e]=s,t}var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};const s=t=>{if("[object Object]"!==Object.prototype.toString.call(t))return!1;const e=Object.getPrototypeOf(t);return null===e||e===Object.prototype},{hasOwnProperty:i}=Object.prototype,{propertyIsEnumerable:n}=Object,o=(t,e,s)=>Object.defineProperty(t,e,{value:s,writable:!0,enumerable:!0,configurable:!0}),a=e,r={concatArrays:!1,ignoreUndefined:!1},d=t=>{const e=[];for(const s in t)i.call(t,s)&&e.push(s);if(Object.getOwnPropertySymbols){const s=Object.getOwnPropertySymbols(t);for(const i of s)n.call(t,i)&&e.push(i)}return e};function h(t){return Array.isArray(t)?function(t){const e=t.slice(0,0);return d(t).forEach((s=>{o(e,s,h(t[s]))})),e}(t):s(t)?function(t){const e=null===Object.getPrototypeOf(t)?Object.create(null):{};return d(t).forEach((s=>{o(e,s,h(t[s]))})),e}(t):t}const l=(t,e,s,i)=>(s.forEach((s=>{void 0===e[s]&&i.ignoreUndefined||(s in t&&t[s]!==Object.getPrototypeOf(t)?o(t,s,c(t[s],e[s],i)):o(t,s,h(e[s])))})),t);function c(t,e,n){return n.concatArrays&&Array.isArray(t)&&Array.isArray(e)?((t,e,s)=>{let n=t.slice(0,0),a=0;return[t,e].forEach((e=>{const r=[];for(let s=0;s<e.length;s++)i.call(e,s)&&(r.push(String(s)),o(n,a++,e===t?e[s]:h(e[s])));n=l(n,e,d(e).filter((t=>!r.includes(t))),s)})),n})(t,e,n):s(e)&&s(t)?l(t,e,d(e),n):h(e)}function f(t,e){const s=window.getComputedStyle(t).getPropertyValue(e);return""===s?null:s}function u(t){const e=parseFloat(t);switch(function(t){let e=t.length;if(!t||!e)return null;let s=e;for(;s--;)if(!isNaN(t[s]))return t.slice(s+1,e)||null;return null}(t)){case null:case"ms":return e;case"s":return 1e3*e;case"m":return 6e4*e;case"h":return 36e5*e;case"d":return 864e5*e;case"w":return 6048e5*e;case"y":return 31536e6*e;default:return null}}function p(t,e){const s=document.createElement(t);if(e)for(let[t,i]of Object.entries(e))t=t.replace(/[A-Z0-9]/g,(t=>`-${t.toLowerCase()}`)),s.setAttribute(t,i);return s}const m={autoHide:!0,onlyOneNotification:!0,parentEl:document.body,position:"top center",animations:"auto"};class y{constructor(t={}){this.mergedOptions=function(...t){const e=c(h(r),this!==a&&this||{},r);let i={_:{}};for(const n of t)if(void 0!==n){if(!s(n))throw new TypeError("`"+n+"` is not an Option Object");i=c(i,{_:n},e)}return i._}(m,t),this.autoHide=this.mergedOptions.autoHide,this.parentEl=this.mergedOptions.parentEl,this.position=this.mergedOptions.position,this.motionPref=this.mergedOptions.animations,this.instanceId=null,this.nId=1,this.nodes={},this.msgData={},this.timeoutIds={},this.events={},this.onlyOne={set:this.mergedOptions.onlyOneNotification,states:{},nextMsgData:{}},this.animatedRun=null}get animated(){switch(this.motionPref){case"undefined":case"auto":return!window.matchMedia("(prefers-reduced-motion: reduce)").matches;default:return this.motionPref}}get hideCallTimeout(){switch(this.autoHide){case!0:return 3500;case!1:return 0;default:return this.autoHide}}init(){if(this.instanceId)throw new Error(`SN: .init() has already been called on this instance (${this.instanceId}).`);this.instanceId=Math.floor(99999*Math.random()),this.nodes.wrapper=p(y.nodeSkeletons.wrapper.tagName,y.nodeSkeletons.wrapper.attrs),this.nodes.wrapper.dataset.instanceId=this.instanceId;const t=this.parentEl.firstElementChild,e=t.classList.contains("simple-notifier")?t.nextElementSibling:t;this.parentEl.insertBefore(this.nodes.wrapper,e);const s=this.position.split(" ");1===s.length&&(s[1]="center"),this.nodes.wrapper.classList.add(`${y.nodeClasses.wrapper}--pos-y-${s[0]}`,`${y.nodeClasses.wrapper}--pos-x-${s[1]}`),this.events.allDestroyed=new CustomEvent("allNotificationsDestroyed",{detail:{instanceId:this.instanceId}})}destroy(){if(!this.instanceId)throw new Error("SN: Instance isn't initialized!");this.runningDestroy||(this.runningDestroy=!0,this.nodes.wrapper.addEventListener("allNotificationsDestroyed",(t=>{this.nodes.wrapper.remove(),this.onlyOne&&(this.onlyOne.states={},this.onlyOne.nextMsgData={}),this.events={},this.nId=1,this.instanceId=null,delete this.runningDestroy})),this.hide())}show(t,e){if(!this.instanceId)throw new Error("SN: Instance isn't initialized!");if(this.onlyOne.set){if(this.onlyOne.states.inReshow)return;if(this.onlyOne.states.isVisible)return void this._reshowNotification(t,e)}let s=this.nId;this.onlyOne.set||this.nId++,this._initNotification(s),this._getMsgData(s,t,e),this._showNewNotification(s)}_initNotification(t){this.nodes[t]={};for(const[e,s]of Object.entries(y.nodeSkeletons))"wrapper"!==e&&(this.nodes[t][e]=p(s.tagName,s.attrs),"notification"===e?this.nodes.wrapper.insertBefore(this.nodes[t][e],this.nodes.wrapper.firstElementChild):this.nodes[t].notification.append(this.nodes[t][e]));this.nodes[t].notification.dataset.notificationId=t,this.timeoutIds[t]={},this.events[t]={},this.events[t].shown=new CustomEvent("notificationShown",{detail:{instanceId:this.instanceId,notificationId:t}}),this.events[t].destroyed=new CustomEvent("notificationDestroyed",{detail:{instanceId:this.instanceId,notificationId:t}}),this.nodes.wrapper.addEventListener("notificationShown",this.events[t].shown,{once:!0}),this.nodes.wrapper.addEventListener("notificationDestroyed",this.events[t].destroyed,{once:!0})}_getMsgData(t,e,s){e||(this.onlyOne.nextMsgData?(e=this.onlyOne.nextMsgData.text,s=this.onlyOne.nextMsgData.type,this.onlyOne.nextMsgData={}):(e=y.defaultMsgData.notext.text,s=y.defaultMsgData.notext.type)),s||(s=y.defaultMsgData.notype.type),this.msgData[t]={},this.msgData[t].text=e,this.msgData[t].type=s}_showNewNotification(t){if(this.animatedRun=this.animated,this.nodes[t].message.textContent=this.msgData[t].text,this.nodes[t].notification.classList.add(`${y.nodeClasses.notification}--${this.msgData[t].type}`,y.nodeClasses.shown),this.animatedRun){this.nodes[t].notification.classList.add(y.nodeClasses.anim.base,y.nodeClasses.anim.show);const e=u(f(this.nodes[t].notification,"animation-duration"));this.timeoutIds[t].showAnim=setTimeout((()=>{this.nodes[t].notification.classList.remove(y.nodeClasses.anim.show)}),e)}this.onlyOne.set&&(this.onlyOne.states.isVisible=!0),this.nodes.wrapper.dispatchEvent(this.events[t].shown),this.hideCallTimeout>0?this.timeoutIds[t].hideCall=setTimeout((()=>{this.hide(t)}),this.hideCallTimeout):this.animatedRun=null}_reshowNotification(t,e){this.onlyOne.states.inReshow=!0,this.onlyOne.nextMsgData.text=t,this.onlyOne.nextMsgData.type=e,clearTimeout(this.timeoutIds[1].hideCall),this.hide(1)}hide(t){if(!this.instanceId)throw new Error("SN: Instance isn't initialized!");if(this.onlyOne.set){if(this.onlyOne.states.inHide)return;this.onlyOne.states.inHide=!0}let e;if("number"==typeof t){if("undefined"===this.msgData[t])return;e=[t]}if(void 0===t)if(e=Object.keys(this.msgData),e.length>0)Object.values(this.timeoutIds).forEach((t=>{Object.values(t).forEach((t=>{clearTimeout(t)}))}));else{if(!this.runningDestroy)return;this.nodes.wrapper.dispatchEvent(this.events.allDestroyed)}let s=1;e.forEach((t=>{this._hideNotification(t),s++,this.onlyOne.set&&s>e.length&&(this.onlyOne.states.inHide=!1)}))}_hideNotification(t){null===this.animatedRun&&(this.animatedRun=this.animated);let e=0;this.animatedRun&&(this.nodes[t].notification.classList.add(y.nodeClasses.anim.hide),e=u(f(this.nodes[t].notification,"animation-duration"))),this.timeoutIds[t].hideAnim=setTimeout((()=>{this.nodes[t].notification.classList.remove(y.nodeClasses.shown),this.nodes[t].notification.className=this.nodes[t].notification.className.replace(y.nodeClasses.typeRegex,""),this.animatedRun&&this.nodes[t].notification.classList.remove(y.nodeClasses.anim.hide),this.onlyOne.set&&(this.onlyOne.states.isVisible=!1),this._destroyNotification(t)}),e)}_destroyNotification(t){const e=Object.keys(this.nodes[t]),s=Object.values(this.nodes[t]);new Promise((t=>{let i=0;s.forEach((s=>{s.remove(),i++,i===e.length&&t("All nodes have been removed succesfully.")}))})).then((()=>{this.animatedRun=null,delete this.nodes[t],delete this.msgData[t],delete this.timeoutIds[t],this.nodes.wrapper.dispatchEvent(this.events[t].destroyed),delete this.events[t],0===Object.keys(this.msgData).length&&this.nodes.wrapper.dispatchEvent(this.events.allDestroyed),this.onlyOne.set&&this.onlyOne.states.inReshow&&(this.onlyOne.states.inReshow=!1,this.show())})).catch((t=>{throw new Error(t)}))}}return t(y,"nodeClasses",{wrapper:"simple-notifier",notification:"simple-notification",typeRegex:/simple-notification--[A-Za-z]+/g,shown:"is-shown",anim:{base:"animated",show:"fadeIn",hide:"fadeOut"}}),t(y,"nodeSkeletons",{wrapper:{tagName:"div",attrs:{class:y.nodeClasses.wrapper}},notification:{tagName:"div",attrs:{class:y.nodeClasses.notification,role:"alert"}},message:{tagName:"p",attrs:{class:`${y.nodeClasses.notification}__message`}}}),t(y,"defaultMsgData",{notext:{text:"This is some dummy text for you, because none was passed in.",type:"debug"},notype:{type:"default"}}),y}));
//# sourceMappingURL=simple-notifier.bundle.min.js.map